Wow, this is slow. I ought to find out a way to parralize this, and make it go faster. . .
